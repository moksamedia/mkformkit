'use strict';exports.__esModule=true;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _react=require('react');var _react2=_interopRequireDefault(_react);var _ValidatedFormGroup=require('./ValidatedFormGroup');var _ValidatedFormGroup2=_interopRequireDefault(_ValidatedFormGroup);var _rubix=require('@sketchpixy/rubix');var _utils=require('@moksa/utils');var _utils2=_interopRequireDefault(_utils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}/**
 * Created by cantgetnosleep on 10/6/16.
 */var _Utils$PhoneUtils=_utils2.default.PhoneUtils,validatePhoneNumber=_Utils$PhoneUtils.validatePhoneNumber,normalizePhoneNumber=_Utils$PhoneUtils.normalizePhoneNumber,phoneTypes=_Utils$PhoneUtils.phoneTypes;var email_regex=_utils2.default.Regexes.email_regex;var ContactInfo=function(_Component){_inherits(ContactInfo,_Component);function ContactInfo(props){_classCallCheck(this,ContactInfo);var _this=_possibleConstructorReturn(this,_Component.call(this,props));_this.state={phoneNumber:{value:'',validationState:null,validationMessage:''},email:{value:'',validationState:null,validationMessage:''},name:{value:'',validationState:null,validationMessage:''},visibility:'attendees'};return _this;}ContactInfo.prototype.handleChangePhoneNumber=function handleChangePhoneNumber(e){var value=e.target.value;if(value==''){this.setState({phoneNumber:{value:'',validationState:null,validationMessage:null}});this.props.handleChange({phone:null,validationState:null},this.props.identifier);return;}var phoneNumberNormalized=normalizePhoneNumber(value);if(validatePhoneNumber(phoneNumberNormalized)){this.setState({phoneNumber:{value:phoneNumberNormalized,validationState:'success',validationMessage:null}});this.props.handleChange({phone:phoneNumberNormalized,validationState:'success'},this.props.identifier);}else{this.setState({phoneNumber:{value:value,validationState:'error',validationMessage:'That does not appear to be a valid phone number.'}});}};// NAME
ContactInfo.prototype.handleChangeName=function handleChangeName(e){var value=e.target.value;this.setState({name:{value:value,validationState:'success',validationMessage:null}});this.props.onChange({name:value},this.props.identifier);};// EMAIL
ContactInfo.prototype.handleChangeEmail=function handleChangeEmail(e){var value=e.target.value;// if empty
if(value==''){this.setState({email:{value:'',validationState:null,validationMessage:null}});this.props.handleChange({email:null},this.props.identifier);return;}// if valid email
if(email_regex.test(value)){this.setState({email:{value:value,validationState:'success',validationMessage:null}});this.props.handleChange({email:value,validationState:'success'},this.props.identifier);}// if not valid email
else{this.setState({email:{value:value,validationState:'error',validationMessage:'That does not appear to be a valid email.'}});this.props.handleChange({email:null,validationState:'error'},this.props.identifier);}};// VISIBILITY
ContactInfo.prototype.handleChangeVisibility=function handleChangeVisibility(e){var value=e.target.value;this.setState({visibility:value});this.props.handleChange({visibility:value},this.props.identifier);};ContactInfo.prototype.render=function render(){var _this2=this;var _props=this.props,identifier=_props.identifier,title=_props.title;return _react2.default.createElement(_rubix.Well,null,_react2.default.createElement('h4',null,title),_react2.default.createElement(_ValidatedFormGroup2.default,_extends({controlId:identifier+'Name',label:'Name',placeHolder:'Who you gonna call?'},this.state.name,{handleChange:function handleChange(e){_this2.handleChangeName(e);}})),_react2.default.createElement(_ValidatedFormGroup2.default,_extends({controlId:identifier+'Phone',label:'Phone number',placeHolder:'444-333-1212'},this.state.phoneNumber,{handleChange:function handleChange(e){_this2.handleChangePhoneNumber(e);}})),_react2.default.createElement(_ValidatedFormGroup2.default,_extends({controlId:identifier+'Email',label:'Email',placeHolder:'email@domain.com'},this.state.email,{handleChange:function handleChange(e){_this2.handleChangeEmail(e);}})),_react2.default.createElement(_rubix.FormGroup,{controlId:identifier+'Visibility',onChange:this.handleChangeVisibility.bind(this)},_react2.default.createElement(_rubix.ControlLabel,null,'Decide who can see ',title),_react2.default.createElement(_rubix.FormControl,{componentClass:'select',placeholder:'select',defaultValue:'attendees'},_react2.default.createElement('option',{value:'anyone'},'Anyone. Contact info is public. (Watch our for spam)'),_react2.default.createElement('option',{value:'registered'},'Registered users with a validated email.'),_react2.default.createElement('option',{value:'applicantsAndAttendees'},'Applicants and people accepted into the retreat.'),_react2.default.createElement('option',{value:'attendees'},'Only people who have been accepted into the retreat.'),_react2.default.createElement('option',{value:'byrequest'},'Shared by request only.'))));};return ContactInfo;}(_react.Component);ContactInfo.propTypes={title:_react2.default.PropTypes.string.isRequired,identifier:_react2.default.PropTypes.string.isRequired,handleChange:_react2.default.PropTypes.func.isRequired};exports.default=ContactInfo;